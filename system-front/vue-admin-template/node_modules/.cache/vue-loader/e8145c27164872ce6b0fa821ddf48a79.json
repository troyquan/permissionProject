{"remainingRequest":"C:\\Users\\troybaba\\Desktop\\SpringProject\\system-front\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\troybaba\\Desktop\\SpringProject\\system-front\\vue-admin-template\\src\\views\\system\\sysRole\\assignAuth.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\troybaba\\Desktop\\SpringProject\\system-front\\vue-admin-template\\src\\views\\system\\sysRole\\assignAuth.vue","mtime":1681847082880},{"path":"C:\\Users\\troybaba\\Desktop\\SpringProject\\system-front\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1680926457384},{"path":"C:\\Users\\troybaba\\Desktop\\SpringProject\\system-front\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":1680926458399},{"path":"C:\\Users\\troybaba\\Desktop\\SpringProject\\system-front\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1680926457384},{"path":"C:\\Users\\troybaba\\Desktop\\SpringProject\\system-front\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":1680926458823}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBhcGkgZnJvbSAnQC9hcGkvc3lzdGVtL21lbnUuanMnCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAncm9sZUF1dGgnLAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsIC8vIOeUqOadpeagh+ivhuaYr+WQpuato+WcqOS/neWtmOivt+axguS4reeahOagh+ivhiwg6Ziy5q2i6YeN5aSN5o+Q5LqkCiAgICAgIHN5c01lbnVMaXN0OiBbXSwgLy8g5omA5pyJCiAgICAgIGRlZmF1bHRQcm9wczogewogICAgICAgIGNoaWxkcmVuOiAnY2hpbGRyZW4nLAogICAgICAgIGxhYmVsOiAnbmFtZScKICAgICAgfSwKICAgIH07CiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZmV0Y2hEYXRhKCkKICB9LAoKICBtZXRob2RzOiB7CiAgICAvKgogICAg5Yid5aeL5YyWCiAgICAqLwogICAgZmV0Y2hEYXRhKCkgewogICAgICBjb25zdCByb2xlSWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5pZAogICAgICBhcGkudG9Bc3NpZ24ocm9sZUlkKS50aGVuKHJlc3VsdCA9PiB7CiAgICAgICAgY29uc3Qgc3lzTWVudUxpc3QgPSByZXN1bHQuZGF0YQogICAgICAgIHRoaXMuc3lzTWVudUxpc3QgPSBzeXNNZW51TGlzdAogICAgICAgIGNvbnN0IGNoZWNrZWRJZHMgPSB0aGlzLmdldENoZWNrZWRJZHMoc3lzTWVudUxpc3QpCiAgICAgICAgY29uc29sZS5sb2coJ2dldFBlcm1pc3Npb25zKCkgY2hlY2tlZElkcycsIGNoZWNrZWRJZHMpCiAgICAgICAgdGhpcy4kcmVmcy50cmVlLnNldENoZWNrZWRLZXlzKGNoZWNrZWRJZHMpCiAgICAgIH0pCiAgICB9LAoKICAgIC8qCiAgICDlvpfliLDmiYDmnInpgInkuK3nmoRpZOWIl+ihqAogICAgKi8KICAgIGdldENoZWNrZWRJZHMgKGF1dGhzLCBpbml0QXJyID0gW10pIHsKICAgICAgcmV0dXJuIGF1dGhzLnJlZHVjZSgocHJlLCBpdGVtKSA9PiB7CiAgICAgICAgaWYgKGl0ZW0uc2VsZWN0ICYmIGl0ZW0uY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICBwcmUucHVzaChpdGVtLmlkKQogICAgICAgIH0gZWxzZSBpZiAoaXRlbS5jaGlsZHJlbikgewogICAgICAgICAgdGhpcy5nZXRDaGVja2VkSWRzKGl0ZW0uY2hpbGRyZW4sIGluaXRBcnIpCiAgICAgICAgfQogICAgICAgIHJldHVybiBwcmUKICAgICAgfSwgaW5pdEFycikKICAgIH0sCgogICAgLyoKICAgIOS/neWtmOadg+mZkOWIl+ihqAogICAgKi8KICAgIHNhdmUoKSB7CiAgICAgIGRlYnVnZ2VyCiAgICAgIC8v6I635Y+W5Yiw5b2T5YmN5a2Q6IqC54K5CiAgICAgIC8vY29uc3QgY2hlY2tlZE5vZGVzID0gdGhpcy4kcmVmcy50cmVlLmdldENoZWNrZWROb2RlcygpCiAgICAgIC8v6I635Y+W5Yiw5b2T5YmN5a2Q6IqC54K55Y+K54i26IqC54K5CiAgICAgIGNvbnN0IGFsbENoZWNrZWROb2RlcyA9IHRoaXMuJHJlZnMudHJlZS5nZXRDaGVja2VkTm9kZXMoZmFsc2UsIHRydWUpOwogICAgICBsZXQgaWRMaXN0ID0gYWxsQ2hlY2tlZE5vZGVzLm1hcChub2RlID0+IG5vZGUuaWQpOwogICAgICBjb25zb2xlLmxvZyhpZExpc3QpCiAgICAgIGxldCBhc3NnaW5NZW51Vm8gPSB7CiAgICAgICAgcm9sZUlkOiB0aGlzLiRyb3V0ZS5xdWVyeS5pZCwKICAgICAgICBtZW51SWRMaXN0OiBpZExpc3QKICAgICAgfQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIGFwaS5kb0Fzc2lnbihhc3NnaW5NZW51Vm8pLnRoZW4ocmVzdWx0ID0+IHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXN1bHQuJG1lc3NhZ2UgfHwgJ0FTU0lHTiBTVUNDRVNTRlVMTFknKQogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvc3lzdGVtL3N5c1JvbGUnKTsKICAgICAgfSkKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["assignAuth.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAqBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"assignAuth.vue","sourceRoot":"src/views/system/sysRole","sourcesContent":["<template>\r\n    <div class=\"app-container\">\r\n      <div style=\"padding: 20px 20px 0 20px;\">\r\n        Assign To：{{ $route.query.roleName }}\r\n      </div>\r\n      <el-tree\r\n        style=\"margin: 20px 0\"\r\n        ref=\"tree\"\r\n        :data=\"sysMenuList\"\r\n        node-key=\"id\"\r\n        show-checkbox\r\n        default-expand-all\r\n        :props=\"defaultProps\"\r\n      />\r\n      <div style=\"padding: 20px 20px;\">\r\n        <el-button :loading=\"loading\" type=\"primary\" icon=\"el-icon-check\" size=\"mini\" @click=\"save\">保存</el-button>\r\n        <el-button @click=\"$router.push('/system/sysRole')\" size=\"mini\" icon=\"el-icon-refresh-right\">返回</el-button>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  <script>\r\n    import api from '@/api/system/menu.js'\r\n    export default {\r\n      name: 'roleAuth',\r\n  \r\n      data() {\r\n        return {\r\n          loading: false, // 用来标识是否正在保存请求中的标识, 防止重复提交\r\n          sysMenuList: [], // 所有\r\n          defaultProps: {\r\n            children: 'children',\r\n            label: 'name'\r\n          },\r\n        };\r\n      },\r\n  \r\n      created() {\r\n        this.fetchData()\r\n      },\r\n  \r\n      methods: {\r\n        /*\r\n        初始化\r\n        */\r\n        fetchData() {\r\n          const roleId = this.$route.query.id\r\n          api.toAssign(roleId).then(result => {\r\n            const sysMenuList = result.data\r\n            this.sysMenuList = sysMenuList\r\n            const checkedIds = this.getCheckedIds(sysMenuList)\r\n            console.log('getPermissions() checkedIds', checkedIds)\r\n            this.$refs.tree.setCheckedKeys(checkedIds)\r\n          })\r\n        },\r\n  \r\n        /*\r\n        得到所有选中的id列表\r\n        */\r\n        getCheckedIds (auths, initArr = []) {\r\n          return auths.reduce((pre, item) => {\r\n            if (item.select && item.children.length === 0) {\r\n              pre.push(item.id)\r\n            } else if (item.children) {\r\n              this.getCheckedIds(item.children, initArr)\r\n            }\r\n            return pre\r\n          }, initArr)\r\n        },\r\n  \r\n        /*\r\n        保存权限列表\r\n        */\r\n        save() {\r\n          debugger\r\n          //获取到当前子节点\r\n          //const checkedNodes = this.$refs.tree.getCheckedNodes()\r\n          //获取到当前子节点及父节点\r\n          const allCheckedNodes = this.$refs.tree.getCheckedNodes(false, true);\r\n          let idList = allCheckedNodes.map(node => node.id);\r\n          console.log(idList)\r\n          let assginMenuVo = {\r\n            roleId: this.$route.query.id,\r\n            menuIdList: idList\r\n          }\r\n          this.loading = true\r\n          api.doAssign(assginMenuVo).then(result => {\r\n            this.loading = false\r\n            this.$message.success(result.$message || 'ASSIGN SUCCESSFULLY')\r\n            this.$router.push('/system/sysRole');\r\n          })\r\n        }\r\n      }\r\n    };\r\n  </script>"]}]}